<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Complete Ontario Real Estate Transaction Tool</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- THEME TOGGLE BUTTON -->
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        <svg class="theme-toggle-icon" id="theme-icon-light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <path d="m12 7-4-4M12 17l-4 4M17 12h4M7 12H3M15.54 8.46l2.83-2.83M5.17 19.83l2.83-2.83M8.46 15.54l-2.83 2.83M19.83 5.17l-2.83 2.83"></path>
        </svg>
        <svg class="theme-toggle-icon hidden" id="theme-icon-dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
        <span id="theme-text">Dark</span>
    </button>

    <header class="header">
        <div class="container">
            <div class="header__content">
                <div class="header__branding">
                    <h1 class="header__title">Ontario Real Estate Transaction Tool</h1>
                    <p class="header__subtitle">Full Compliance Edition | RECO | FINTRAC | PIPEDA</p>
                </div>
                <div class="header__logo">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9,22 9,12 15,12 15,22"></polyline>
                    </svg>
                </div>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">

            <!-- WIZARD PROGRESS -->
            <div class="wizard-header">
                <div class="wizard-progress-container">
                    <div class="wizard-progress-track">
                        <div class="wizard-progress-fill" id="progress-fill" style="width: 25%"></div>
                    </div>
                </div>
                <div class="wizard-step-labels" id="wizard-steps-indicator">
                    <div class="wizard-step-label active" data-step="1">
                        <span class="step-circle">1</span>
                        <span class="step-text">Basics</span>
                    </div>
                    <div class="wizard-step-label" data-step="2">
                        <span class="step-circle">2</span>
                        <span class="step-text">Representation</span>
                    </div>
                    <div class="wizard-step-label" data-step="3">
                        <span class="step-circle">3</span>
                        <span class="step-text">Details</span>
                    </div>
                    <div class="wizard-step-label" data-step="4">
                        <span class="step-circle">4</span>
                        <span class="step-text">Review</span>
                    </div>
                </div>
            </div>

            <!-- Universal Mandatory Forms (Always Visible or First Step? Let's keep it separate for awareness, or better, put it in Results)
                 Actually, the original design had it at the top.
                 To keep it clean, let's move it to Step 4 (Results) or a dedicated Info section.
                 The user wanted "User Friendly". Hiding the big warning block initially is friendlier.
                 I will move it to the Results section.
            -->

            <form id="transaction-form" class="form wizard-form">

                <!-- STEP 1 -->
                <div class="wizard-step active" data-step="1">
                    <div class="card">
                        <div class="card__header">
                            <h2>Step 1: Transaction Basics</h2>
                            <p class="text-secondary">Let's start with the fundamental details of the property and client.</p>
                        </div>
                        <div class="card__body">
                            <!-- NEW: Transaction Type Selector -->
                            <div class="form-group">
                                <label class="form-label">Transaction Type <span class="required">*</span></label>
                                <div class="form-group__options">
                                    <label class="radio-option">
                                        <input type="radio" name="transaction_type" value="purchase" required checked>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Purchase</span>
                                            <div class="radio-option__description">Buying property</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="transaction_type" value="selling" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                            <circle cx="12" cy="8" r="1.5" fill="currentColor"></circle>
                                            <path d="M9 2l3-1 3 1"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Selling</span>
                                            <div class="radio-option__description">Listing property for sale</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="transaction_type" value="rental" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                            <path d="M16 2v4M8 2v4M3 10h18"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Rental / Lease</span>
                                            <div class="radio-option__description">Leasing property</div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Property Type <span class="required">*</span></label>
                                <div class="form-group__options" id="property-type-options">
                                    <!-- PURCHASE & SELLING OPTIONS -->
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="residential_freehold" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Residential Freehold</span>
                                            <div class="radio-option__description">Houses, townhomes, detached properties</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="residential_condo" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
                                            <path d="M9 22v-4h6v4M8 6h.01M16 6h.01M12 6h.01M8 10h.01M16 10h.01M12 10h.01M8 14h.01M16 14h.01M12 14h.01"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Residential Condo</span>
                                            <div class="radio-option__description">Condo units, apartments</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="commercial" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M3 21h18M3 7v1a3 3 0 0 0 3 3h2a3 3 0 0 0 3-3V7m0 0V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2m0 0v1a3 3 0 0 0 3 3h2a3 3 0 0 0 3-3V7m-9 4v10m-6 0V11"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Commercial</span>
                                            <div class="radio-option__description">Office, retail, industrial</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="vacant_land" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M3 20h18M5.6 20C5.03 20 4.75 20 4.55 19.82c-.2-.18-.24-.48-.32-1.07L3 6h18l-1.23 12.75c-.08.59-.12.89-.32 1.07-.2.18-.48.18-1.05.18"></path>
                                            <path d="M3 6l2.45-2.45A2 2 0 0 1 6.87 3h10.26a2 2 0 0 1 1.42.59L21 6"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Vacant Land</span>
                                            <div class="radio-option__description">Undeveloped lots</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="new_construction" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M12 3v18m0-18l-8 8m8-8l8 8M5 11v9a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-9"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">New Construction</span>
                                            <div class="radio-option__description">Pre-construction, newly built</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option" data-transaction-type="purchase,selling">
                                        <input type="radio" name="property_type" value="business_purchase" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                            <line x1="12" y1="22.08" x2="12" y2="12"></line>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Business Sale/Purchase</span>
                                            <div class="radio-option__description">Buying or selling existing business</div>
                                        </div>
                                    </label>

                                    <!-- RENTAL OPTIONS -->
                                    <label class="radio-option property-option hidden" data-transaction-type="rental">
                                        <input type="radio" name="property_type" value="residential_rental">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <rect x="9" y="12" width="6" height="10"></rect>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Residential Rental</span>
                                            <div class="radio-option__description">Houses, condos, apartments for lease</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option hidden" data-transaction-type="rental">
                                        <input type="radio" name="property_type" value="commercial_rental">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M3 21h18M3 7v1a3 3 0 0 0 3 3h2a3 3 0 0 0 3-3V7m0 0V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2m0 0v1a3 3 0 0 0 3 3h2a3 3 0 0 0 3-3V7m-9 4v10m-6 0V11"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Commercial Rental</span>
                                            <div class="radio-option__description">Office, retail, industrial lease</div>
                                        </div>
                                    </label>
                                    <label class="radio-option property-option hidden" data-transaction-type="rental">
                                        <input type="radio" name="property_type" value="business_rental">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Business Rental</span>
                                            <div class="radio-option__description">Leasing business in premises</div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Client Type <span class="required">*</span></label>
                                <div class="form-group__options">
                                    <label class="radio-option">
                                        <input type="radio" name="client_type" value="individual" required>
                                        <div>
                                            <span class="radio-option__label">Individual</span>
                                            <div class="radio-option__description">Personal buyers/sellers</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="client_type" value="corporate" required>
                                        <div>
                                            <span class="radio-option__label">Corporate</span>
                                            <div class="radio-option__description">Companies, corporations</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="client_type" value="mixed" required>
                                        <div>
                                            <span class="radio-option__label">Mixed</span>
                                            <div class="radio-option__description">Individual + Corporate</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STEP 2 -->
                <div class="wizard-step hidden" data-step="2">
                    <div class="card">
                        <div class="card__header">
                             <h2>Step 2: Representation & Financing</h2>
                             <p class="text-secondary">Define your relationship with the client and how funds are handled.</p>
                        </div>
                        <div class="card__body">
                             <div class="form-group">
                                <label class="form-label">Representation Status <span class="required">*</span></label>
                                <div class="form-group__options">
                                    <label class="radio-option">
                                        <input type="radio" name="representation_status" value="client_represented" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                            <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Client Represented</span>
                                            <div class="radio-option__description">You represent the client</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="representation_status" value="self_represented" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Self-Represented</span>
                                            <div class="radio-option__description">Party represents themselves</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="representation_status" value="multiple_representation" required>
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="radio-option__icon">
                                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                            <path d="M23 21v-2a4 4 0 0 0-3-3.87m-4-12a4 4 0 0 1 0 7.75"></path>
                                        </svg>
                                        <div>
                                            <span class="radio-option__label">Multiple Representation</span>
                                            <div class="radio-option__description">You represent both parties</div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Fund Handling <span class="required">*</span></label>
                                <div class="form-group__options">
                                    <label class="radio-option">
                                        <input type="radio" name="fund_handling" value="deposits_received" required>
                                        <div>
                                            <span class="radio-option__label">Deposits Received</span>
                                            <div class="radio-option__description">Brokerage handles funds</div>
                                        </div>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="fund_handling" value="no_funds" required>
                                        <div>
                                            <span class="radio-option__label">No Funds Handled</span>
                                            <div class="radio-option__description">No deposit handling</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STEP 3 -->
                <div class="wizard-step hidden" data-step="3">
                    <div class="card">
                         <div class="card__header">
                             <h2>Step 3: Specific Details</h2>
                             <p class="text-secondary">Select any additional factors that apply to this transaction.</p>
                         </div>
                         <div class="card__body">
                            <div class="form-group">
                                <label class="form-label">Additional Characteristics</label>
                                <div class="form-group__options form-group__options--checkboxes">
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="high_value">
                                        <span class="checkbox-option__label">High Value ($1M+)</span>
                                    </label>
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="out_of_province">
                                        <span class="checkbox-option__label">Out-of-Province Clients</span>
                                    </label>
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="foreign_nationals">
                                        <span class="checkbox-option__label">Foreign Nationals</span>
                                    </label>
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="expedited">
                                        <span class="checkbox-option__label">Expedited Timeline</span>
                                    </label>
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="needs_financing">
                                        <span class="checkbox-option__label">Needs Financing</span>
                                    </label>
                                    <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="first_time_buyer">
                                        <span class="checkbox-option__label">First-Time Buyer</span>
                                    </label>
                                     <label class="checkbox-option">
                                        <input type="checkbox" name="transaction_details" value="rural">
                                        <span class="checkbox-option__label">Rural Property</span>
                                    </label>
                                </div>
                            </div>
                         </div>
                    </div>
                </div>

                <!-- WIZARD NAVIGATION -->
                <div class="wizard-navigation">
                    <button type="button" id="prevBtn" class="btn btn--secondary btn--large hidden" style="min-width: 120px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                        Back
                    </button>
                    <button type="button" id="nextBtn" class="btn btn--primary btn--large" style="min-width: 140px;">
                        Next
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 8px;">
                            <path d="M9 18l6-6-6-6"/>
                        </svg>
                    </button>
                    <button type="submit" id="submitBtn" class="btn btn--success btn--large hidden" style="min-width: 180px;">
                        Generate Analysis
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 8px;">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                    </button>
                </div>
            </form>

            <!-- RESULTS SECTION -->
            <div id="results-section" class="results-section hidden">

                <div class="text-center" style="margin-bottom: var(--space-32);">
                    <button id="restartBtn" class="btn btn--outline">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                             <path d="M1 4v6h6"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
                        </svg>
                        Edit / Restart Transaction
                    </button>
                </div>


                 <!-- Combined Forms Section -->
                 <div class="card">
                    <div class="card__header">
                        <h2>Required Forms</h2>
                    </div>
                    <div class="card__body">
                        <!-- Universal Mandatory Forms -->
                        <div style="margin-bottom: var(--space-32);">
                            <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--primary); margin-bottom: var(--space-20); padding-bottom: var(--space-12); border-bottom: 2px solid var(--primary);">
                                Mandatory Forms (All Transactions)
                            </h3>
                            <div id="universal-forms-list" class="universal-forms-list"></div>
                        </div>

                        <!-- Property-Specific Forms -->
                        <div>
                            <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--primary); margin-bottom: var(--space-20); padding-bottom: var(--space-12); border-bottom: 2px solid var(--primary);">
                                Property-Specific Forms
                            </h3>
                            <div id="property-forms-list" class="property-forms-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Clauses -->
                <div class="card">
                     <div class="card__header">
                        <h2>Clause Recommendations</h2>
                     </div>
                     <div class="card__body">
                         <div class="clauses-section">
                            <div class="clause-category">
                                <h3 class="clause-category__title">Mandatory</h3>
                                <div id="mandatory-clauses" class="clauses-list"></div>
                            </div>
                            <div class="clause-category">
                                <h3 class="clause-category__title">Recommended</h3>
                                <div id="recommended-clauses" class="clauses-list"></div>
                            </div>
                            <div class="clause-category">
                                <h3 class="clause-category__title">Conditional</h3>
                                <div id="conditional-clauses" class="clauses-list"></div>
                            </div>
                        </div>
                     </div>
                </div>

                <!-- Compliance -->
                <div class="card">
                    <div class="card__header">
                        <h2>Compliance Checklist</h2>
                    </div>
                     <div class="card__body">
                        <div id="compliance-checklist" class="compliance-checklist"></div>
                    </div>
                </div>

                <!-- Export -->
                 <div class="card">
                    <div class="card__header">
                        <h2>Actions</h2>
                    </div>
                    <div class="card__body">
                        <div class="export-actions">
                             <button id="copy-all-clauses" class="btn btn--primary">Copy All Clauses</button>
                             <button id="generate-summary" class="btn btn--success">Transaction Summary</button>
                             <button id="print-checklist" class="btn btn--secondary">Print Checklist</button>
                             <button id="export-forms" class="btn btn--secondary">Export Forms List</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
             <div class="footer__content">
                <p class="footer__disclaimer">
                    <strong>Disclaimer:</strong> Tool for educational/compliance aid purposes. Consult legal counsel.
                </p>
                <p class="footer__copyright">Â© 2025 Ontario Real Estate Compliance Tool</p>
            </div>
        </div>
    </footer>

    <div id="copy-toast" class="copy-toast">
        <div class="copy-toast__content">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20,6 9,17 4 12"></polyline>
            </svg>
            <span class="copy-toast__text">Copied!</span>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
